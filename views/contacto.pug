extends layout

block contenido
    
  #contacto
  
    if lang == "es"
      script.
        let textos_lbl = {
          Telegram : "Cuenta o nÃºmero",
          Mail : "DirecciÃ³n",
          Instagram : "Cuenta",
          Facebook : "Cuenta",
          Whatsapp : "NÃºmero",
          Otro : "Â¿CÃ³mo te contactamos?"
        }
        
      h2 Contacto
      p Â¿QuerÃ©s preguntar o comentarnos algo? Â¿Nos querÃ©s mandar un abrazo? Â¿Nos invitÃ¡s un mate? Â¡Escribinos! Nos llega por telegram 
      .g
        label Â¿Nos decÃ­s tu nombre?
        input#nombre
      .g
        label Â¿Por dÃ³nde te podemos responder?
        select#medio Telegram
          option Telegram
          option Mail
          option Instagram
          option Whatsapp
          option Facebook
          option Otro
      .g
        label#mutante Cuenta o nÃºmero
        input#direccion
        
    if lang == "en"
      script.
        let textos_lbl = {
          Telegram : "Username or number",
          Mail : "Address",
          Instagram : "Account",
          Facebook : "Username or id",
          Whatsapp : "Number",
          Another : "How can we contact you?"
        }
        
      h2 Contact Us
      p Would you like to ask anything? Do you want to send us a hug? Can you invite us a #[em mate]? Write us! It arrives on telegram
      .g
        label Â¿Would you tell us your name?
        input#nombre
      .g
        label Â¿Where can we reach you?
        select#medio Telegram
          option Telegram
          option Mail
          option Instagram
          option Whatsapp
          option Facebook
          option Another
      .g
        label#mutante Username or number
        input#direccion
        
    if lang == "fr"
      script.
        let textos_lbl = {
          Telegram : "Nom d'utilisateur ou numÃ©ro",
          Mail : "Adresse",
          Instagram : "Compte",
          Facebook : "Nom d'utilisateur ou identifiant",
          Whatsapp : "NumÃ©ro",
          Autre : "Comment pouvons-nous vous contacter?"
        }
      h2 Nous contacter
      p Voulez-vous demander ou commenter quelque chose? Voulez-vous nous envoyer un cÃ¢lin? Peux-tu nous inviter un #[em mate]? Ã‰crivez-nous! Il nous vient par telegram
      .g
        label Pouvez-vous nous dire votre nom ?
        input#nombre
      .g
        label OÃ¹ pouvons-nous vous rÃ©pondre ?
        select#medio Telegram
          option Telegram
          option Mail
          option Instagram
          option Whatsapp
          option Facebook
          option Autre
      .g
        label#mutante Cuenta o nÃºmero
        input#direccion
        
    if lang == "pt"
      script.
        let textos_lbl = {
          Telegram : "Nome de usuÃ¡rio ou nÃºmero",
          Mail : "DireÃ§Ã£o",
          Instagram : "Conta",
          Facebook : "Nome de usuÃ¡rio ou id",
          Whatsapp : "Telefone",
          Outro : "Como podemos entrar em contato com vocÃª?"
        }
        
      h2 Contate-nos
      p VocÃª gostaria de perguntar alguma coisa? VocÃª quer nos enviar um abraÃ§o? VocÃª pode nos convidar um #[em mate]? Escreva para nÃ³s! Chega em telegram
      .g
        label VocÃª poderia nos dizer seu nome?
        input#nombre
      .g
        label Onde podemos encontrar vocÃª?
        select#medio Telegram
          option Telegram
          option Mail
          option Instagram
          option Whatsapp
          option Facebook
          option Outro
      .g
        label#mutante Nome de usuÃ¡rio ou nÃºmero
        input#direccion
        
    textarea#texto
    p#flash
    button#enviar(onclick="enviar()") Enviar
    ul(style="margin-top: 3em;") 
      li conveargentinademalabares@gmail.com
      li #[a(href="https://www.instagram.com/conveargentinademalabares/") Instagram] 
      li #[a(href="https://www.facebook.com/convencionargentinademalabares/") Facebook]
    
  

  script.
  
    let lbl = document.querySelector("#mutante")
    document.querySelector("#medio").value = "Telegram"
    
    document.querySelector('#medio').addEventListener('change', e => {
      lbl.textContent = textos_lbl[e.target.value]
    })


    let enviar = () => {
      let nombre = document.querySelector('#nombre').value
      let medio = document.querySelector('#medio').value
      let direccion = document.querySelector('#direccion').value
      let texto = document.querySelector('#texto').value
      
      if(nombre == "" ||Â medio == "" ||Â direccion == "" ||Â texto == ""){
        flash("Â¡Faltan datos!")
        return 
      } 
      
      fetch('/contacto',{
        method: 'post',
        headers: {
          'Content-Type' : 'application/json'
        },
        body: JSON.stringify({nombre, medio, direccion, texto})
      })
      .then(r => r.json())
      .then(r => r.ok ? flash("Â¡Enviado! Gracias ðŸ˜") : flash("Hay que esperar un ratito para mandar otro mensaje che..."))
    }

    let flash = (texto) =>Â {
      let f = document.querySelector("#flash")
      f.textContent = texto
      f.classList.add("visible")
      setTimeout(() => {
        f.classList.remove("visible")
      }, 5000)
    } 
